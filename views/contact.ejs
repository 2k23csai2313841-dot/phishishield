<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contact - PhishShield</title>

    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/styleindex.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"
    />
  </head>
  <body>
    <%- include('./partials/nav') %>

    <main class="main-content">
      <section class="contact-hero">
        <h1>ðŸ“ž Get in Touch</h1>
        <p>
          Have any questions, suggestions, or feedback? We'd love to hear from
          you!
        </p>
      </section>

      <section class="contact-form-section">
        <form id="contactForm">
          <input
            type="text"
            id="name"
            name="name"
            placeholder="Your Name"
            required
          />
          <input
            type="email"
            id="email"
            name="email"
            placeholder="Your Email"
            required
          />
          <input
            type="text"
            id="subject"
            name="subject"
            placeholder="Your Subject"
            required
          />
          <textarea
            id="message"
            name="message"
            placeholder="Your Message"
            rows="6"
            required
          ></textarea>
          <button type="submit">Send Message</button>
          <div id="loadingSpinner" class="spinner" style="display: none"></div>
        </form>
      </section>
      <div
        class="contact-InfoDiv"
        style="display: flex; justify-content: center"
      >
        <section class="contact-info">
          <h2>ðŸ“§ Other Ways to Reach Us</h2>
          <p>
            Email:
            <a class="contact-link" href="mailto:anubhavsingh2027@gmail.com"
              >anubhavsingh2027@gmail.com</a
            >
          </p>
          <p>
            Whatsapp No:
            <a
              class="contact-link"
              href="https://api.whatsapp.com/send?phone=7355026966"
              >7355026966</a
            >
          </p>
        </section>
      </div>
    </main>

    <%- include('./partials/footer') %>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // ===== auto-resize textarea =====
        const messageTextarea = document.getElementById("message");
        if (messageTextarea) {
          messageTextarea.addEventListener("input", function () {
            this.style.height = "auto";
            this.style.height = this.scrollHeight + "px";
          });
        }

        // ===== contact form logic =====
        const contactForm = document.getElementById("contactForm");
        const loadingSpinner = document.getElementById("loadingSpinner");

        if (!contactForm) return;

        contactForm.addEventListener("submit", async (e) => {
          e.preventDefault();

          const name =
            (document.getElementById("name") || {}).value?.trim() || "";
          const email =
            (document.getElementById("email") || {}).value?.trim() || "";
          const subject =
            (document.getElementById("subject") || {}).value?.trim() || "";
          const message =
            (document.getElementById("message") || {}).value?.trim() || "";

          if (!name || !email || !subject || !message) {
            toastr.error("Please fill in all fields.", "Validation Error");
            return;
          }

          // show spinner
          if (loadingSpinner) loadingSpinner.style.display = "block";

          try {
            const response = await fetch("/contact", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ name, email, subject, message }),
            });

            const data = await response.json();

            if (!response.ok || !data.success) {
              toastr.error(
                data.message || "Failed to send message. Please try again.",
                "Error"
              );
              return;
            }

            // Success
            contactForm.reset();
            toastr.success(data.message, "Success");
          } catch (err) {
            console.error("Contact form error:", err);
            toastr.error(
              "An error occurred while sending your message. Please try again later.",
              "Error"
            );
          } finally {
            if (loadingSpinner) loadingSpinner.style.display = "none";
          }
        });
      });
    </script>
  </body>
</html>
